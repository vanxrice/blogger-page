<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../polymer-jsonp/polymer-jsonp.html">

<link rel="import" href="blogger-post.html">

<!--
A basic Polymer web component that fetches a Blogger feed over JSON.

##### Example

    <blogger-page blogtitle="vxrice"></blogger-page>

@element blogger-page
@blurb A basic Polymer web component that fetches a Blogger feed over JSON.
@status alpha
@homepage http://vanxrice.github.io/blogger-page
@demo http://vanxrice.github.io/blogger-page/demo.html
-->
<polymer-element name="blogger-page" attributes="blogtitle">
  <template is="auto binding">
    <style>
      :host {
        display: block;
      }
    </style>

    <polymer-jsonp auto handleAs="json"
      url="http://{{blogtitle}}.blogspot.com/feeds/posts/default?alt=json&callback="
      response="{{response}}"
      on-polymer-response="{{onResponse}}">
    </polymer-jsonp>

    <template if="{{feed}}">
      <h1>{{feed.title.$t}}</h1>
      <hr/>
      <div>
        <template repeat="{{post in feed.entry}}">
          <blogger-post post="{{post}}"></blogger-post>
          <hr/>
        </template>
      </div>
    </template>

    <content></content>
  </template>
  <script>
    Polymer({
      /**
       * The `blogtitle` attribute sets the blog to fetch data from.
       *
       * @attribute blogtitle
       * @type string
       * @default 'googleblog'
       */
      blogtitle: 'googleblog',

      onResponse: function(e) {
        if (this.response) {
          if (this.response.feed) {
            this.feed = this.response.feed;
          }
        }
      }
    });
  </script>
</polymer-element>
